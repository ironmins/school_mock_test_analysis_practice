# 고등학교 모의고사 성적 분석 프로그램 Web

전주고등학교의 모의고사 성적 분석 VBA 매크로를 웹 애플리케이션으로 구현한 버전입니다.

## 🎯 주요 기능

### 1. 데이터 업로드
- Excel 파일 (XLSX, XLSM) 업로드 지원
- 다중 파일 동시 업로드 가능
- 드래그 앤 드롭 인터페이스
- DATA 시트 자동 인식

### 2. 전체 통계 분석
- **전체 학생 수 집계**
- **평균 백분위/표준점수/원점수** 계산
- **학급별 백분위 분포** 차트
- **영역별 평균 등급** 시각화

### 3. 과목별 분석
- **국어, 수학, 영어** 주요 과목 통계
- 과목별 **원점수, 표준점수, 백분위, 등급** 평균
- 과목별 비교 차트

### 4. 학급별 분석
- 학급별 **학생 수, 평균 점수** 통계
- 학급 간 성적 비교 차트
- 학급별 순위 확인

### 5. 학생별 분석
- **학년/반/번호** 필터링
- **이름 검색** 기능
- 개별 학생 상세 성적 조회
- 전체 학생 목록 테이블

### 6. 데이터 출력
- **Excel 통합 데이터 내보내기**
- **HTML 분석 결과 저장**
- PDF 생성 (예정)

## 📋 엑셀 파일 형식

### DATA 시트 구조

프로그램은 **DATA**라는 이름의 시트를 자동으로 찾아 분석합니다.

#### 헤더 구조 (1-2행)

**1행 (영역명):**
```
학년 | 반 | 번호 | 이름 | 국어영역 | 수학영역 | 영어영역 | 탐구1과목 | 탐구2과목 | 탐구3과목 | 제2외국어 | 총계
```

**2행 (세부항목):**
```
학년 | 반 | 번호 | 이름 | 국어과목 | 원점수 | 표준점수 | 백분위 | 등급 | 수학과목 | 원점수 | 표준점수 | 백분위 | 등급 | ...
```

#### 데이터 구조 (3행 이후)

| 컬럼 | 항목 | 설명 |
|------|------|------|
| A (1) | 학년 | 학년 (예: 1) |
| B (2) | 반 | 반 (예: 1, 2, 3...) |
| C (3) | 번호 | 학생 번호 |
| D (4) | 이름 | 학생 이름 |
| E-I (5-9) | 국어 | 과목명, 원점수, 표준점수, 백분위, 등급 |
| J-N (10-14) | 수학 | 과목명, 원점수, 표준점수, 백분위, 등급 |
| O-S (15-19) | 영어 | 과목명, 원점수, 표준점수, 백분위, 등급 |
| U-Y (21-25) | 탐구1 | 과목명, 원점수, 표준점수, 백분위, 등급 |
| Z-AD (26-30) | 탐구2 | 과목명, 원점수, 표준점수, 백분위, 등급 |
| AE-AI (31-35) | 탐구3 | 과목명, 원점수, 표준점수, 백분위, 등급 |
| AJ-AN (36-40) | 제2외국어 | 과목명, 원점수, 표준점수, 백분위, 등급 |
| AS-AU (45-47) | 총계 | 원점수, 표준점수, 백분위 |

#### 샘플 데이터

```
1 | 1 | 1 | 강수호 | 국어 | 56 | 104 | 56.56 | 5 | 수학 | 59 | 114 | 75.56 | 4 | ...
1 | 1 | 2 | 김다원 | 국어 | 35 | 80 | 17.36 | 7 | 수학 | 54 | 109 | 67.23 | 4 | ...
```

## 🚀 사용 방법

### 1. 파일 준비

1. Excel 파일에 **DATA** 시트 생성
2. 위 형식에 맞춰 성적 데이터 입력
3. XLSX 또는 XLSM 형식으로 저장

### 2. 분석 실행

1. 웹 페이지에서 파일 업로드
2. **분석 시작** 버튼 클릭
3. 각 탭에서 결과 확인

### 3. 결과 활용

- **전체 통계**: 학년 전체 성적 경향 파악
- **과목별 분석**: 과목별 강약점 확인
- **학급별 분석**: 학급 간 비교
- **학생별 분석**: 개별 학생 성적 조회

## 🔒 보안

- **완전한 클라이언트 사이드 처리**
- 모든 데이터는 **사용자의 브라우저**에서만 처리
- **서버 전송 없음** - 업로드된 파일이 외부로 유출되지 않음
- 페이지를 닫으면 **데이터 완전 삭제**

## 🛠️ 기술 스택

### 프론트엔드
- HTML5, CSS3, Vanilla JavaScript
- 반응형 디자인

### 라이브러리 (CDN)
- **[SheetJS (xlsx)](https://sheetjs.com/)**: Excel 파일 파싱
- **[Chart.js 4.4.0](https://www.chartjs.org/)**: 데이터 시각화
- **[chartjs-plugin-datalabels](https://chartjs-plugin-datalabels.netlify.app/)**: 차트 레이블
- **[jsPDF](https://github.com/parallax/jsPDF)**: PDF 생성
- **[html2canvas](https://html2canvas.hertzen.com/)**: HTML-to-Canvas 변환

## 📁 파일 구조

```
mock-exam-analyzer/
├── index.html          # 메인 UI
├── script.js           # 분석 로직 (MockExamAnalyzer 클래스)
├── style.css           # 스타일링
└── README.md           # 이 파일
```

## 🎨 주요 화면

### 전체 통계
- 전체 학생 수, 평균 백분위/표준점수/원점수
- 학급별 백분위 분포 차트
- 영역별 평균 등급 차트

### 과목별 분석
- 국어, 수학, 영어 평균 통계 카드
- 과목별 점수 비교 차트

### 학급별 분석
- 학급별 통계 테이블
- 학급별 평균 비교 라인 차트

### 학생별 분석
- 필터링 (학년/반/번호)
- 이름 검색
- 전체 테이블 / 개인 상세 뷰

## 📊 차트 종류

1. **막대 그래프 (Bar Chart)**
   - 학급별 백분위 분포
   - 영역별 평균 등급
   - 과목별 점수 비교

2. **선 그래프 (Line Chart)**
   - 학급별 평균 비교

## 🔧 커스터마이징

### 과목 추가

`script.js`의 `parseStudentData()` 메서드에서 과목 매핑을 수정하세요:

```javascript
subjects: {
    korean: { name: '국어', raw: row[5], ... },
    math: { name: '수학', raw: row[10], ... },
    english: { name: '영어', raw: row[15], ... },
    // 새 과목 추가
    newSubject: { name: '새과목', raw: row[20], ... }
}
```

### 차트 색상 변경

`script.js`의 각 차트 생성 메서드에서 `backgroundColor`를 수정하세요.

## ⚠️ 주의사항

1. **파일 형식**: XLSX 또는 XLSM만 지원
2. **시트 이름**: 반드시 **DATA** 시트 필요
3. **데이터 위치**: 3행부터 학생 데이터 시작
4. **브라우저**: 최신 Chrome, Firefox, Edge, Safari 권장
5. **파일 크기**: 대용량 파일(1000명 이상)은 처리 시간이 걸릴 수 있음

## 🐛 문제 해결

### 파일이 분석되지 않는 경우
1. DATA 시트가 있는지 확인
2. 헤더가 올바른지 확인 (1-2행)
3. 브라우저 콘솔에서 오류 확인 (F12)

### 차트가 표시되지 않는 경우
1. 인터넷 연결 확인 (CDN 라이브러리 로드 필요)
2. 브라우저 캐시 삭제 후 재시도

### 검색이 작동하지 않는 경우
1. 데이터가 올바르게 로드되었는지 확인
2. 브라우저 콘솔 확인

## 📄 라이선스

이 프로젝트는 교육 목적으로 자유롭게 사용 가능합니다.

## 👨‍💻 개발 배경

전주고등학교의 VBA 매크로 기반 모의고사 성적 분석 시스템을 웹으로 포팅하여, 어디서나 쉽게 사용할 수 있도록 만들었습니다.

## 📞 문의

문제가 발생하거나 개선 사항이 있으면 GitHub Issues를 통해 알려주세요.

---

**참고**: 이 프로그램은 개인정보를 다루므로, 사용 시 관련 법규를 준수해주시기 바랍니다.
